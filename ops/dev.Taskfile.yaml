version: "3"

tasks:
  generate-dev-env:
    vars:
      ROOT_DOMAIN_OVERRIDE: "beta.w3yz.dev"
      SHOP_NAME_OVERRIDE: "demo"
    env:
      SHOP_NAME_OVERRIDE: "{{.SHOP_NAME_OVERRIDE}}"
      ROOT_DOMAIN_OVERRIDE: "{{.ROOT_DOMAIN_OVERRIDE}}"
      NODE_ENV: "development"
    cmds:
      - rm -rf .env
      - bash ./ops/scripts/generate-dev-env.sh
      - source .env

  generate-prod-env:
    requires:
      vars:
        - "ROOT_DOMAIN_OVERRIDE"
        - "SHOP_NAME_OVERRIDE"
    env:
      SHOP_NAME_OVERRIDE: "{{.SHOP_NAME_OVERRIDE}}"
      ROOT_DOMAIN_OVERRIDE: "{{.ROOT_DOMAIN_OVERRIDE}}"
      NODE_ENV: "production"
    cmds:
      - rm -rf .env
      - echo "Generating production environment for {{.SHOP_NAME_OVERRIDE}}"
      - bash ./ops/scripts/generate-prod-env.sh
      - source .env
